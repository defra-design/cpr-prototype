{% extends "layout-private-beta-research.html" %}

{% set serviceName %}
Report packaging data
{% endset%}

{% set serviceName = "Report packaging data" %}

{% block pageTitle %}
Report packaging data
{% endblock %}

{% block header %}

{# Set serviceName in config.js. #}

{{ govukHeader({
homepageUrl: "../../../index.html",
serviceName: "Report packaging data",
serviceUrl: "#",
navigation: [
{
href: "landing-page.html",
text: "Home"
},
{
href: "#",
text: "Manage account"
},
{
href: "#",
text: "Sign out"
}
]
}) }}

{{ govukPhaseBanner({
tag: {
text: "prototype"
},
html: 'This is not a live service.',
classes: 'govuk-width-container'
}) }}

{% endblock %}

{% block beforeContent %}

<style>
  .card {
    min-height: 180px;
  }
</style>


<nav class="defra-language-select" aria-label="Language switcher">

       {{ govukBackLink({
            text: "Back",
            href: "javascript:history.back()"
        }) }}

  <ul class="defra-language-select__list">
    <li class="defra-language-select__list-item">
      <span aria-current="true">English</span>
    </li>
    <li class="defra-language-select__list-item">
      <a href="?cy" hreflang="cy" lang="cy" rel="alternate" class="govuk-link"
        data-journey-click="link - click:lang-select:Cymraeg">
        <span class="govuk-visually-hidden">Newid yr iaith ir Gymraeg</span>
        <span aria-hidden="true">Cymraeg</span>
      </a>
    </li>

  </ul>

</nav>


{% endblock %}

{% block content %}
<!-- Page layout start 1 -->
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <div id="radio-group" class="govuk-form-group govuk-!-margin-top-0">
       <span class="govuk-caption-l">Small producer 2026 registration</span>
      <h1 class="govuk-heading-l">How to pay your registration fee</h1>
      <!-- Page layout end 1 -->

      <!-- Content Start -->
      <p class="govuk-body">You can pay your registration fee of <strong>Â£8,290.00 </strong> in 1 of 3 ways:</p>
      <ul class="govuk-list govuk-list--bullet">
        <li>By bank transfer</li>
        <li>By phone</li>
        <li>Online through GOV.UK</li>
      </ul>
      <p class="govuk-body">Select a payment method.</p>

      {% from "govuk/components/radios/macro.njk" import govukRadios %}
      <form id="agreementForm" novalidate>
        <fieldset id="radio-fieldset" class="govuk-fieldset">

          <!-- Error Message -->
          <span id="error-message" class="govuk-error-message" style="display: none;">
            Please select an option
          </span>

          {{ govukRadios({
          name: "agreement",
          value: data['agreement'],
          items: [
          {
          value: "pay-bank-transfer",
          text: "Pay by bank transfer"
          },
          {
          value: "pay-online",
          text: "Pay Online"
          },
          {
          value: "pay-by-phone",
          text: "Pay by phone"
          }
          ]
          }) }}
        </fieldset>

        <br><br>

        {{ govukButton({
        text: "Continue",
        attributes: {
        id: "submitButton",
        onclick: "handleSubmit(event)"
        }
        }) }}
      </form>

      <style>
        /* Error styling only for the legend and error message */
        .govuk-fieldset--error {
          padding-left: 15px;
          border-left: 5px solid #d4351c;
        }
      </style>

      <script>
        function handleSubmit(event) {
          event.preventDefault(); // Prevent form submission

          const form = document.getElementById('agreementForm');
          const fieldset = document.getElementById('radio-fieldset');
          const errorMessage = document.getElementById('error-message');
          const agreement = form.querySelector('input[name="agreement"]:checked');

          if (agreement) {
            // Hide error message and remove error styling
            errorMessage.style.display = 'none';
            fieldset.classList.remove('govuk-fieldset--error');

            // Save selected value and redirect
            localStorage.setItem('selectedProducer', agreement.value);

            if (agreement.value === 'pay-bank-transfer') {
              window.location.href = 'payment-by-bank-transfer';
            } else if (agreement.value === 'pay-online') {
              window.location.href = 'payment-online';
            } else if (agreement.value === 'pay-by-phone') {
              window.location.href = 'payment-by-phone';
            }
          } else {
            // Show error message and add error styling
            errorMessage.style.display = 'block';
            fieldset.classList.add('govuk-fieldset--error');
          }
        }

        // Add listener for clicks outside the form to validate
        document.addEventListener('click', (event) => {
          const form = document.getElementById('agreementForm');
          const fieldset = document.getElementById('radio-fieldset');
          const errorMessage = document.getElementById('error-message');
          const agreement = form.querySelector('input[name="agreement"]:checked');

          // If clicking outside and no option selected, show error
          if (!form.contains(event.target) && !agreement) {
            errorMessage.style.display = 'block';
            fieldset.classList.add('govuk-fieldset--error');
          }
        });
      </script>
      <!-- Content end-->

      <!-- Page layout start 2 -->
    </div>
  </div>
  {% endblock %}