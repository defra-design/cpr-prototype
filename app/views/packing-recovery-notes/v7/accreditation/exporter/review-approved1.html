  {% set serviceName = "Registration" %}

  {% extends "layout.html" %}

  {% block beforeContent %}

    {{ govukBackLink ({
        text: "Back",
        href: "javascript:history.back()"
    }) }}
  {% endblock %}

  {% block pageTitle %}
      {{serviceName}} prototype
  {% endblock %}
  {% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds-from-desktop">


      <h1 id="org-heading" class="govuk-heading-l">Interim sites used when exporting to ...</h1>


  <div class="govuk-inset-text">
    There is a charge per site. You must pay this after you've submitted your application.
    <BR> <BR>    
    <div style="display: flex; gap: 40px;">      
    <a href="interim-site-details">
          <input class="govuk-button" type="submit" value="Add another interim site" />
        </a>
  </div>
  </div>
      <div class="govuk-form-group">

    <!--<dl class="govuk-summary-list hmrc-list-with-actions hmrc-list-with-actions--short">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-!-font-weight-regular hmrc-summary-list__key">
          Sydney Russell
        </dt>
        <dd class="govuk-summary-list__actions hmrc-summary-list__actions">
          <ul class="govuk-summary-list__actions-list">
            <li class="govuk-summary-list__actions-list-item"><a class="govuk-link" href="#"><span aria-hidden="true">Change</span><span class="govuk-visually-hidden">Change Sydney Russell</span></a></li>
            <li class="govuk-summary-list__actions-list-item"><a class="govuk-link" href="#"><span aria-hidden="true">Remove</span><span class="govuk-visually-hidden">Remove Sydney Russell from the list</span></a></li>
          </ul>
        </dd>
      </div>
    <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-!-font-weight-regular hmrc-summary-list__key">
          Michael Cain
        </dt>
        <dd class="govuk-summary-list__actions hmrc-summary-list__actions">
          <ul class="govuk-summary-list__actions-list">
            <li class="govuk-summary-list__actions-list-item"><a class="govuk-link" href="#"><span aria-hidden="true">Change</span><span class="govuk-visually-hidden">Change Michael Cain</span></a></li>
            <li class="govuk-summary-list__actions-list-item"><a class="govuk-link" href="#"><span aria-hidden="true">Remove</span><span class="govuk-visually-hidden">Remove Michael Cain from the list</span></a></li>
          </ul>
        </dd>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-!-font-weight-regular hmrc-summary-list__key">
          Jeremy Winter
        </dt>
        <dd class="govuk-summary-list__actions hmrc-summary-list__actions">
          <ul class="govuk-summary-list__actions-list">
            <li class="govuk-summary-list__actions-list-item"><a class="govuk-link" href="#"><span aria-hidden="true">Change</span><span class="govuk-visually-hidden">Change Jeremy Winter</span></a></li>
            <li class="govuk-summary-list__actions-list-item"><a class="govuk-link" href="#"><span aria-hidden="true">Remove</span><span class="govuk-visually-hidden">Remove Jeremy Winter from the list</span></a></li>
          </ul>
        </dd>
      </div>-->
    </dl>
    <!-- <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dd class="govuk-summary-list__value">
          <p class="govuk-body">Sydney and sons</p>
          <p class="govuk-body">sarah.phillips@example.com</p>
          <p class="govuk-body">123 Rue de Paris</p>
          <p class="govuk-body">75001 Paris</p>
          <p class="govuk-body">France</p>
          <p class="govuk-body">+44 1234 567890</p>
        </dd>
        <dd class="govuk-summary-list__actions">
          <ul class="govuk-summary-list__actions-list">
            <li class="govuk-summary-list__actions-list-item">
              <a class="govuk-link" href="./interim-site-details">Edit<span class="govuk-visually-hidden"> contact details</span></a>
            </li>
            <li class="govuk-summary-list__actions-list-item">
              <a class="govuk-link" href="#">Remove site<span class="govuk-visually-hidden"> contact details</span></a>
            </li>
          </ul>
        </dd>
      </div>
    </dl>  -->
  <dl class="govuk-summary-list" id="interim-site-list">
    <!-- JS will insert rows here -->
  </dl>

  </div>
  <form method="post" novalidate action="">
    <!--
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" aria-describedby="add-another-hint">
        <legend class="govuk-fieldset__legend govuk-fieldset__legend govuk-fieldset__legend--m">
          Do you need to add another interim site?
        </legend>
        <div id="add-another-hint" class="govuk-hint">
          You must tell us about all your interim sites.
        </div>
        <div class="govuk-radios govuk-radios--inline" data-module="govuk-radios">
          <div class="govuk-radios__item">
            <input class="govuk-radios__input" id="add-another" name="next-page" type="radio" value="interim-site-details-2">
            <label class="govuk-label govuk-radios__label" for="add-another">
              Yes
            </label>
          </div>
          <div class="govuk-radios__item">
            <input class="govuk-radios__input" id="add-another-2" name="next-page" type="radio" value="check-answers5">
            <label class="govuk-label govuk-radios__label" for="add-another-2">
              No
            </label>
          </div>
        </div>
      </fieldset>
    </div>
  -->
              <button class="govuk-button" formaction="confirm-site2">Save and continue</button> <button class=" govuk-button govuk-button--secondary" formaction="application-saved" style="margin-left: 20px;">Save and come back later</button>

  </form>


  
  </div>
  </div>

  <script>
    function renderInterimSites() {
      const list = document.getElementById("interim-site-list");
      list.innerHTML = ""; // clear old content
      const sites = JSON.parse(localStorage.getItem("interimSites") || "[]");

      if (!sites.length) {
        list.innerHTML = `<p class="govuk-body">No interim sites added yet.</p>`;
        return;
      }

      sites.forEach((site, index) => {
        const entry = document.createElement("div");
        entry.className = "govuk-summary-list__row";

        entry.innerHTML = `
          <dd class="govuk-summary-list__value">
            <p class="govuk-body"><strong>${site.contactName || '-'}</strong></p>
            <p class="govuk-body">${site.email || '-'}</p>
            <p class="govuk-body">${site.addressLine1 || '-'}</p>
            <p class="govuk-body">${site.addressLine2 || ''}</p>
            <p class="govuk-body">${site.addressCounty || '-'}</p>
            <p class="govuk-body">${site.phone || '-'}</p>
          </dd>
          <dd class="govuk-summary-list__actions">
            <ul class="govuk-summary-list__actions-list">
              <li class="govuk-summary-list__actions-list-item">
                <a class="govuk-link" href="interim-site-details?editIndex=${index}">Edit<span class="govuk-visually-hidden"> ${site.contactName}</span></a>
              </li>
              <li class="govuk-summary-list__actions-list-item">
                <a class="govuk-link" href="javascript:(0)" onclick="removeInterimSite(${index})">Remove Site<span class="govuk-visually-hidden"> ${site.contactName}</span></a>
              </li>
            </ul>
          </dd>
        `;
        list.appendChild(entry);
      });
    }

    function removeInterimSite(index) {
      let sites = JSON.parse(localStorage.getItem("interimSites") || "[]");
      if (sites.length > index) {
        sites.splice(index, 1);
        localStorage.setItem("interimSites", JSON.stringify(sites));
        renderInterimSites();
      }
    }

    

    document.addEventListener("DOMContentLoaded", renderInterimSites);
  </script>

  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const orgName = localStorage.getItem("latestInterimOrgName") || "the selected organisation";
    document.getElementById("org-heading").textContent = 
      `Interim sites used when exporting to ${orgName}`;
  });
</script>



  {% endblock %}
